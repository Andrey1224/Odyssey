import React, { useState } from 'react';
import { 
  Star, CheckCircle, Phone, ArrowLeft, 
  ChevronDown, ChevronUp, MapPin, 
  ShieldCheck, ExternalLink, Info, Quote, Home
} from 'lucide-react';

// ==========================================
// 1. ДАННЫЕ (Mock Data)
// ==========================================

const reviewTags = ["All", "Safety", "Easy Access", "Installation", "Aftercare", "Pain Relief"];

const odysseyStories = [
  {
    id: 1,
    name: "Margaret T.",
    location: "Yorkshire",
    date: "15 March 2026",
    product: "Serenity 66 Plus",
    tags: ["Safety", "Pain Relief"],
    title: "I have my independence back",
    text: "Before getting my new walk-in bath, I was terrified of slipping. I hadn't had a proper soak in over two years, relying only on strip washes. The team at Odyssey were incredibly patient, didn't push me into buying, and the installation took exactly one day with zero mess. The heated seat and low threshold have completely changed my life. I can finally bathe with dignity and without fear.",
    hasImage: true
  },
  {
    id: 2,
    name: "David & Susan H.",
    location: "Surrey",
    date: "28 February 2026",
    product: "Walk-In Shower Bath",
    tags: ["Easy Access", "Installation"],
    title: "Perfect for both of us",
    text: "Susan needs the easy access door, while I just prefer a normal shower. This bath gave us the best of both worlds without having to rip out our entire bathroom. The fitters arrived on Tuesday morning and by Wednesday lunchtime we were fully up and running. Very professional service from start to finish.",
    hasImage: false
  },
  {
    id: 3,
    name: "John W.",
    location: "Devon",
    date: "10 January 2026",
    product: "Deep Soaker Bath",
    tags: ["Aftercare"],
    title: "Brilliant customer service",
    text: "The bath is excellent and the upright seat means I can get out easily even with my bad knees. But what really stood out was the aftercare. I couldn't figure out how the microbubble jets worked a week after installation, called the office, and they spent 20 minutes patiently walking me through it on the phone.",
    hasImage: false
  },
];

const trustpilotReviews = [
  {
    id: 101,
    name: "Eleanor Rigby",
    date: "14 February 2026",
    title: "No pressure sales, great result",
    text: "Had quotes from 3 different companies. Odyssey was the only one that didn't stay in my house for 3 hours trying to force a sale. Gave me the price, left me a brochure, and the final installation was top notch.",
    verified: true
  },
  {
    id: 102,
    name: "Arthur Pendelton",
    date: "08 February 2026",
    title: "Quality product, clean fitters",
    text: "The fitters were very polite, put sheets down everywhere, and hoovered up before they left. Bath works perfectly.",
    verified: true
  },
  {
    id: 103,
    name: "M. Foster",
    date: "29 January 2026",
    title: "VAT relief was handled for me",
    text: "I was confused about the VAT exemption forms, but their team handled all the paperwork. Saved me a lot of stress and money.",
    verified: true
  }
];

// ==========================================
// 2. ВСПОМОГАТЕЛЬНЫЕ КОМПОНЕНТЫ
// ==========================================

// Оригинальный зеленый цвет Trustpilot
const TrustpilotStars = () => (
  <div className="flex gap-1" style={{ color: '#00B67A' }}>
    <Star size={24} fill="currentColor" />
    <Star size={24} fill="currentColor" />
    <Star size={24} fill="currentColor" />
    <Star size={24} fill="currentColor" />
    <Star size={24} fill="currentColor" />
  </div>
);

// Компонент раскрывающегося текста (без модалок, с крупной зоной клика)
const ExpandableReview = ({ text, maxLength = 130 }) => {
  const [isExpanded, setIsExpanded] = useState(false);
  const isLong = text.length > maxLength;

  if (!isLong) {
    return <p className="text-[18px] text-slate-600 leading-relaxed">{text}</p>;
  }

  const displayText = isExpanded ? text : `${text.substring(0, maxLength)}...`;

  return (
    <div>
      <p className="text-[18px] text-slate-600 leading-relaxed mb-3">
        {displayText}
      </p>
      {/* Мягкая кнопка без сдвигов, высота 48px */}
      <button 
        onClick={() => setIsExpanded(!isExpanded)}
        className="flex items-center gap-2 text-teal-700 font-bold text-[18px] hover:text-teal-800 hover:bg-teal-50 px-3 py-2 -ml-3 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-teal-500"
        aria-expanded={isExpanded}
      >
        {isExpanded ? (
          <>Show less <ChevronUp size={20} strokeWidth={2.5} /></>
        ) : (
          <>Read full story <ChevronDown size={20} strokeWidth={2.5} /></>
        )}
      </button>
    </div>
  );
};


// ==========================================
// 3. ОСНОВНАЯ СТРАНИЦА
// ==========================================

const OdysseyReviews = () => {
  const [activeTag, setActiveTag] = useState("All");

  const filteredStories = activeTag === "All" 
    ? odysseyStories 
    : odysseyStories.filter(story => story.tags.includes(activeTag));

  return (
    // Базовый фон - мягкий светло-серый/бежевый (как на скрине)
    <div className="bg-slate-50 font-sans text-slate-900 pb-24 min-h-screen">
      
      {/* Навигация */}
      <nav aria-label="Breadcrumb" className="bg-white border-b border-slate-200">
        <div className="max-w-7xl mx-auto px-6 py-4 flex flex-wrap items-center justify-between gap-4">
          <div className="flex items-center gap-2 text-[16px] font-medium text-slate-500">
             <a href="/" className="flex items-center gap-2 hover:text-teal-700 transition-colors px-2 py-2 min-h-[48px]">
               <Home size={20} /> Home
             </a>
             <span aria-hidden="true">/</span>
             <span aria-current="page" className="px-2 py-2 text-slate-900 font-bold">Customer Reviews</span>
          </div>
          
          <button onClick={() => window.history.back()} className="flex items-center gap-2 text-slate-600 hover:text-teal-700 font-bold text-[16px] px-4 py-2 min-h-[48px] rounded-lg transition-colors">
            <ArrowLeft size={20} strokeWidth={2.5} /> Go Back
          </button>
        </div>
      </nav>

      {/* --- 1. HERO --- */}
      <section className="bg-white pt-16 pb-20 px-6 md:px-8 border-b border-slate-200">
        <div className="max-w-5xl mx-auto text-center">
          <h1 className="text-4xl md:text-5xl lg:text-6xl font-extrabold text-slate-900 mb-6 tracking-tight">
            Don't just take our word for it.
          </h1>
          <p className="text-[20px] md:text-[22px] text-slate-600 mb-10 max-w-3xl mx-auto leading-relaxed">
            See why hundreds of families across the UK trust Odyssey to bring safety, comfort, and independence back into their bathrooms.
          </p>

          {/* Плашка доверия */}
          <div className="inline-flex flex-col sm:flex-row items-center gap-6 bg-slate-50 border border-slate-200 rounded-2xl p-6 md:px-8 shadow-sm">
            <TrustpilotStars />
            <div className="h-10 w-px bg-slate-300 hidden sm:block"></div>
            <div className="text-[18px] md:text-[20px] text-slate-700 text-left">
              <span className="font-bold text-slate-900">4.9/5</span> rating on Trustpilot <span className="font-medium text-slate-500">(1,284 reviews)</span>
            </div>
          </div>
        </div>
      </section>

      {/* --- 2. ODYSSEY STORIES --- */}
      <section className="py-16 md:py-24 px-6 md:px-8 max-w-7xl mx-auto">
        
        <div className="text-center mb-12">
          <h2 className="text-3xl md:text-4xl font-extrabold text-slate-900 mb-4 tracking-tight">
            Customer Stories
          </h2>
          <p className="text-[18px] md:text-[20px] text-slate-600 max-w-2xl mx-auto">
            Discover how a new walk-in bath has helped people just like you bathe safely again.
          </p>
        </div>

        {/* Фильтры в стиле чистых кнопок */}
        <div className="flex flex-wrap justify-center items-center gap-3 mb-16">
          <span className="text-[18px] text-slate-500 font-medium mr-2 hidden lg:block">Filter by topic:</span>
          {reviewTags.map(tag => (
            <button
              key={tag}
              onClick={() => setActiveTag(tag)}
              className={`
                text-[16px] md:text-[18px] font-bold py-3 px-6 rounded-full transition-colors min-h-[48px] border focus:outline-none focus:ring-2 focus:ring-teal-500
                ${activeTag === tag 
                  ? 'bg-teal-700 text-white border-teal-700 shadow-md' 
                  : 'bg-white text-slate-600 border-slate-200 hover:bg-slate-50 hover:border-slate-300'
                }
              `}
            >
              {tag}
            </button>
          ))}
        </div>

        {/* Сетка карточек (Элегантная тень, чистый белый фон) */}
        <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {filteredStories.map(story => (
            <div 
              key={story.id} 
              className="bg-white rounded-2xl p-8 shadow-sm hover:shadow-md border border-slate-200 flex flex-col transition-shadow relative"
            >
              {/* Легкая кавычка на фоне для дизайна */}
              <Quote className="absolute top-6 right-6 text-slate-50" size={80} />
              
              <div className="relative z-10 mb-6">
                <div className="flex gap-1 text-yellow-400 mb-4">
                  <Star size={20} fill="currentColor" /><Star size={20} fill="currentColor" /><Star size={20} fill="currentColor" /><Star size={20} fill="currentColor" /><Star size={20} fill="currentColor" />
                </div>
                <h3 className="text-2xl font-bold text-slate-900 leading-tight">
                  "{story.title}"
                </h3>
              </div>

              <div className="flex-grow relative z-10 mb-6">
                <ExpandableReview text={story.text} maxLength={140} />
              </div>

              {/* Футер карточки */}
              <div className="mt-auto pt-6 border-t border-slate-100 relative z-10">
                <div className="flex items-center gap-4 mb-5">
                  <div className="w-12 h-12 rounded-full bg-teal-50 flex items-center justify-center text-teal-700 font-bold text-xl">
                    {story.name.charAt(0)}
                  </div>
                  <div>
                    <div className="flex items-center gap-2 mb-1">
                      <p className="text-[18px] font-bold text-slate-900 leading-none">{story.name}</p>
                      <span className="flex items-center gap-1 text-[13px] font-bold text-emerald-700 bg-emerald-50 border border-emerald-100 px-2 py-0.5 rounded-full">
                        <CheckCircle size={14} /> Verified
                      </span>
                    </div>
                    <p className="text-[15px] text-slate-500 flex items-center gap-1 font-medium">
                      <MapPin size={16} /> {story.location}
                    </p>
                  </div>
                </div>
                
                <div className="bg-slate-50 rounded-lg p-3 text-[16px] text-slate-600 flex justify-between items-center border border-slate-100">
                  <span className="font-medium text-slate-500 text-sm">Product mentioned:</span>
                  <a href="#" className="font-bold text-teal-700 hover:text-teal-800 transition-colors">
                    {story.product}
                  </a>
                </div>
              </div>
            </div>
          ))}
        </div>
      </section>

      {/* --- 3. TRUSTPILOT INDEPENDENT REVIEWS --- */}
      <section className="bg-white border-y border-slate-200 py-16 md:py-24 px-6 md:px-8 mt-4">
        <div className="max-w-7xl mx-auto">
          
          {/* Текстовый мост для доверия */}
          <div className="bg-slate-50 rounded-2xl p-6 md:p-8 mb-12 flex flex-col md:flex-row items-center justify-between gap-6 border border-slate-200">
            <p className="text-[18px] text-slate-700 leading-relaxed max-w-3xl">
              <strong className="text-slate-900 font-bold">Transparency matters.</strong> While we carefully select the detailed stories above to highlight specific features, below you can read every single review exactly as published on Trustpilot.
            </p>
            <ShieldCheck size={48} className="text-slate-300 hidden md:block flex-shrink-0" />
          </div>

          <div className="flex flex-col md:flex-row justify-between items-start md:items-end mb-10 gap-6">
            <div className="max-w-2xl">
              <h2 className="text-3xl md:text-4xl font-extrabold text-slate-900 mb-3 tracking-tight">
                Independent Reviews
              </h2>
            </div>
            <a href="#" className="flex items-center justify-center gap-2 bg-white border-2 border-slate-200 hover:border-slate-300 hover:bg-slate-50 text-slate-800 text-[18px] font-bold min-h-[56px] px-8 rounded-xl transition-colors w-full md:w-auto shadow-sm">
              View all on Trustpilot <ExternalLink size={20} strokeWidth={2.5} />
            </a>
          </div>

          {/* Сортировка */}
          <div className="flex flex-col sm:flex-row items-start sm:items-center gap-4 mb-8 pb-6 border-b border-slate-100">
            <span className="text-[16px] font-bold text-slate-500 uppercase tracking-wide">Sort by:</span>
            <div className="flex flex-wrap gap-2">
              <button className="bg-slate-800 text-white text-[16px] font-bold px-5 py-2 rounded-lg min-h-[48px] focus:outline-none focus:ring-2 focus:ring-slate-400 shadow-sm">Most recent</button>
              <button className="bg-white text-slate-600 border border-slate-200 hover:bg-slate-50 text-[16px] font-bold px-5 py-2 rounded-lg min-h-[48px] focus:outline-none focus:ring-2 focus:ring-slate-400">Highest rating</button>
              <button className="bg-white text-slate-600 border border-slate-200 hover:bg-slate-50 text-[16px] font-bold px-5 py-2 rounded-lg min-h-[48px] focus:outline-none focus:ring-2 focus:ring-slate-400">Lowest rating</button>
            </div>
          </div>

          <div className="grid md:grid-cols-3 gap-6">
            {trustpilotReviews.map(review => (
              <div key={review.id} className="bg-slate-50 rounded-2xl p-8 border border-slate-100">
                <div className="flex flex-col gap-3 mb-5">
                  <TrustpilotStars />
                  <span className="text-slate-500 text-[15px] font-medium">{review.date}</span>
                </div>
                <h4 className="text-[20px] font-bold text-slate-900 mb-3">{review.title}</h4>
                <div className="mb-6">
                  <ExpandableReview text={review.text} maxLength={100} />
                </div>
                <div className="flex items-center gap-3 pt-5 border-t border-slate-200">
                  <div className="w-10 h-10 bg-white rounded-full flex items-center justify-center text-slate-700 font-bold border border-slate-200 shadow-sm">
                    {review.name.charAt(0)}
                  </div>
                  <div>
                    <p className="text-[16px] font-bold text-slate-900 leading-none mb-1">{review.name}</p>
                    {review.verified && (
                      <p className="text-[14px] font-bold text-emerald-700 flex items-center gap-1">
                        <CheckCircle size={16} style={{ color: '#00B67A' }} strokeWidth={2.5} /> Verified
                      </p>
                    )}
                  </div>
                </div>
              </div>
            ))}
          </div>
          
          <div className="text-center mt-12">
            <button className="inline-flex items-center justify-center gap-2 bg-white border border-slate-200 hover:bg-slate-50 hover:border-slate-300 text-slate-700 font-bold text-[18px] min-h-[56px] px-8 rounded-xl transition-colors shadow-sm w-full sm:w-auto">
              Load 10 more reviews
              <ChevronDown size={20} strokeWidth={2.5} />
            </button>
          </div>

        </div>
      </section>

      {/* --- 4. TRANSPARENCY BLOCK --- */}
      <section className="py-16 md:py-24 px-6 max-w-5xl mx-auto">
        <div className="bg-white border border-slate-200 rounded-3xl p-8 md:p-12 flex flex-col md:flex-row gap-8 items-center md:items-start shadow-sm">
          <div className="flex-shrink-0 bg-teal-50 p-5 rounded-2xl">
            <ShieldCheck size={64} className="text-teal-700" strokeWidth={1.5} />
          </div>
          <div>
            <h3 className="text-2xl md:text-3xl font-extrabold text-slate-900 mb-6 text-center md:text-left">
              Our Commitment to Honesty
            </h3>
            <ul className="text-[18px] text-slate-600 space-y-4">
              <li className="flex items-start gap-3">
                <CheckCircle className="text-teal-600 mt-1 flex-shrink-0" size={24} />
                <span className="leading-relaxed"><strong className="text-slate-900">No Editing:</strong> We never alter reviews or hide negative feedback. Every single voice matters.</span>
              </li>
              <li className="flex items-start gap-3">
                <CheckCircle className="text-teal-600 mt-1 flex-shrink-0" size={24} />
                <span className="leading-relaxed"><strong className="text-slate-900">Verified Buyers:</strong> Invitations to leave a review are sent automatically only after your bath is fully installed.</span>
              </li>
              <li className="flex items-start gap-3">
                <CheckCircle className="text-teal-600 mt-1 flex-shrink-0" size={24} />
                <span className="leading-relaxed"><strong className="text-slate-900">We Listen:</strong> If there's an issue, our UK team uses these reviews to reach out and fix it immediately.</span>
              </li>
            </ul>
          </div>
        </div>
      </section>

      {/* --- 5. FINAL CTA --- */}
      <section className="max-w-5xl mx-auto px-6 mb-12">
        <div className="bg-slate-900 rounded-[2rem] p-10 md:p-16 text-center text-white shadow-xl relative overflow-hidden">
          
          {/* Декоративный паттерн */}
          <div className="absolute top-0 right-0 p-12 opacity-5 pointer-events-none">
            <Star size={200} fill="currentColor" />
          </div>

          <div className="relative z-10">
            <h2 className="text-3xl md:text-4xl lg:text-5xl font-extrabold mb-6 leading-tight tracking-tight">
              Ready to feel safe <br className="hidden md:block"/> in your bathroom again?
            </h2>
            <p className="text-[20px] text-slate-300 mb-10 max-w-2xl mx-auto leading-relaxed">
              Call our friendly team today. We provide clear prices and honest advice, without the high-pressure sales pitch.
            </p>
            
            <div className="flex flex-col sm:flex-row items-center justify-center gap-4">
              <a href="tel:08001234567" className="flex items-center justify-center gap-3 bg-white text-slate-900 text-[20px] font-extrabold min-h-[60px] px-8 rounded-xl hover:bg-slate-100 transition-colors w-full sm:w-auto">
                <Phone size={24} className="text-teal-700" strokeWidth={2.5} />
                0800 123 4567
              </a>
              <button className="bg-teal-700 hover:bg-teal-600 text-white text-[20px] font-bold min-h-[60px] px-8 rounded-xl transition-colors border border-teal-600 w-full sm:w-auto">
                Get a Free Quote
              </button>
            </div>
            <p className="text-[16px] text-slate-400 mt-6 flex items-center justify-center gap-2 font-medium">
              <Info size={18} /> Mon-Fri 9am to 5pm
            </p>
          </div>
        </div>
      </section>

    </div>
  );
};

export default OdysseyReviews;
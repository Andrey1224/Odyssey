import React, { useState } from 'react';
import { 
  Home, ArrowLeft, Printer, Share2, Mail, 
  Phone, Clock, Tag, ChevronRight, CheckCircle, 
  ShieldCheck, Info, FileText
} from 'lucide-react';

// ==========================================
// 1. ДАННЫЕ СТАТЬИ (Mock Data from Sanity)
// ==========================================

const articleData = {
  title: "How to Claim 0% VAT on Your Walk-In Bath",
  excerpt: "Did you know that if you have a long-term illness or disability, you might be exempt from paying VAT? Learn how the simple process works and what conditions qualify.",
  category: "VAT & Funding",
  readTime: "5 min read",
  publishedAt: "12 March 2026",
  coverImage: "Senior woman reviewing documents at table",
  tableOfContents: [
    { id: "what-is-vat-relief", title: "What is VAT Relief?" },
    { id: "who-qualifies", title: "Who qualifies for 0% VAT?" },
    { id: "eligible-conditions", title: "Examples of eligible conditions" },
    { id: "how-to-claim", title: "How to claim your exemption" }
  ]
};

const relatedArticles = [
  {
    id: 2,
    category: "Buying Guides",
    title: "Walk-In Bath vs. Shower Bath: Which is Right for You?",
    excerpt: "Choosing between a deep soaker and a shower bath depends on your mobility and bathroom size.",
    readTime: "8 min read",
    date: "05 March 2026"
  },
  {
    id: 5,
    category: "Buying Guides",
    title: "Top 3 Safety Features to Look For in a Mobility Bath",
    excerpt: "From low-threshold doors to anti-slip bases, ensure your new bath has these essential features.",
    readTime: "7 min read",
    date: "02 February 2026"
  },
  {
    id: 3,
    category: "Health & Mobility",
    title: "5 Ways Warm Water Therapy Helps Arthritis Pain",
    excerpt: "Discover the science behind hydrotherapy and how features like microbubbles provide natural relief.",
    readTime: "6 min read",
    date: "28 February 2026"
  }
];

// ==========================================
// 2. ОСНОВНАЯ СТРАНИЦА СТАТЬИ
// ==========================================

const OdysseyArticle = () => {
  const [copied, setCopied] = useState(false);

  // Имитация "Share with family" (копирование ссылки)
  const handleCopyLink = () => {
    navigator.clipboard.writeText(window.location.href);
    setCopied(true);
    setTimeout(() => setCopied(false), 3000);
  };

  const handlePrint = () => {
    window.print();
  };

  return (
    <div className="bg-slate-50 font-sans text-slate-900 pb-24 min-h-screen">
      
      {/* --- НАВИГАЦИЯ (Хлебные крошки) --- */}
      <nav aria-label="Breadcrumb" className="bg-white border-b border-slate-200 print:hidden">
        <div className="max-w-7xl mx-auto px-6 py-4 flex flex-wrap items-center justify-between gap-4">
          <div className="flex items-center gap-2 text-[16px] font-medium text-slate-500">
             <a href="/" className="flex items-center gap-2 hover:text-teal-700 transition-colors px-2 py-2 min-h-[48px] rounded focus:outline-none focus:ring-2 focus:ring-teal-500">
               <Home size={20} /> <span className="hidden sm:inline">Home</span>
             </a>
             <span aria-hidden="true">/</span>
             <a href="/guides" className="hover:text-teal-700 transition-colors px-2 py-2 min-h-[48px] rounded focus:outline-none focus:ring-2 focus:ring-teal-500">
               Advice & Guides
             </a>
             <span aria-hidden="true">/</span>
             <span aria-current="page" className="px-2 py-2 text-slate-900 font-bold truncate max-w-[200px] sm:max-w-none">
               {articleData.category}
             </span>
          </div>
          
          <button onClick={() => window.history.back()} className="flex items-center gap-2 text-slate-600 hover:text-teal-700 font-bold text-[16px] px-4 py-2 min-h-[48px] rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-teal-500">
            <ArrowLeft size={20} strokeWidth={2.5} /> Go Back
          </button>
        </div>
      </nav>

      {/* --- 1. ЗАГОЛОВОК СТАТЬИ (Hero) --- */}
      <header className="bg-white pt-12 pb-16 px-6 md:px-8 border-b border-slate-200">
        <div className="max-w-4xl mx-auto">
          
          {/* Мета-данные */}
          <div className="flex flex-wrap items-center gap-4 mb-6">
            <span className="bg-teal-50 text-teal-800 border border-teal-200 text-[15px] font-bold px-4 py-1.5 rounded-md flex items-center gap-2">
              <Tag size={16} /> {articleData.category}
            </span>
            <span className="text-slate-500 font-medium text-[16px] flex items-center gap-2">
              <Clock size={18} /> {articleData.readTime}
            </span>
            <span className="text-slate-500 font-medium text-[16px] hidden sm:inline">•</span>
            <span className="text-slate-500 font-medium text-[16px]">{articleData.publishedAt}</span>
          </div>

          {/* H1 и Excerpt */}
          <h1 className="font-serif text-4xl md:text-5xl lg:text-6xl font-extrabold text-slate-900 mb-6 leading-tight tracking-tight">
            {articleData.title}
          </h1>
          <p className="text-[22px] md:text-[24px] text-slate-600 leading-relaxed font-medium mb-10">
            {articleData.excerpt}
          </p>

          {/* Обложка (Cover Image) */}
          <div className="w-full h-64 md:h-96 bg-slate-200 rounded-2xl border border-slate-300 overflow-hidden relative flex items-center justify-center print:hidden">
            <span className="text-slate-500 font-bold text-xl">[Image: {articleData.coverImage}]</span>
          </div>

        </div>
      </header>

      {/* --- 2. ТЕЛО СТАТЬИ (Сайдбар + Контент) --- */}
      <section className="py-12 px-6 md:px-8 max-w-7xl mx-auto">
        <div className="grid lg:grid-cols-12 gap-12 items-start">
          
          {/* ЛЕВЫЙ САЙДБАР (Липкий) */}
          <aside className="lg:col-span-4 lg:sticky lg:top-8 print:hidden">
            
            {/* Оглавление (Table of Contents) */}
            <div className="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm mb-6">
              <h3 className="font-bold text-slate-900 text-[18px] mb-4 flex items-center gap-2 uppercase tracking-wide">
                <FileText size={20} className="text-teal-700" /> In this guide
              </h3>
              <ul className="space-y-3">
                {articleData.tableOfContents.map((heading, index) => (
                  <li key={index}>
                    <a href={`#${heading.id}`} className="text-[18px] text-slate-600 hover:text-teal-700 font-medium transition-colors inline-block focus:outline-none focus:ring-2 focus:ring-teal-500 rounded px-1 -ml-1">
                      {heading.title}
                    </a>
                  </li>
                ))}
              </ul>
            </div>

            {/* Блок действий для пожилых (Share & Print) */}
            <div className="bg-slate-100 rounded-2xl p-6 border border-slate-200">
              <h3 className="font-bold text-slate-900 text-[18px] mb-4">Save or Share</h3>
              <div className="flex flex-col gap-3">
                <button 
                  onClick={handlePrint}
                  className="flex items-center gap-3 bg-white border border-slate-300 hover:bg-slate-50 text-slate-800 text-[18px] font-bold min-h-[48px] px-4 rounded-xl transition-colors focus:outline-none focus:ring-4 focus:ring-slate-400"
                >
                  <Printer size={20} className="text-slate-500" /> Print this article
                </button>
                
                <button 
                  onClick={handleCopyLink}
                  className="flex items-center gap-3 bg-white border border-slate-300 hover:bg-slate-50 text-slate-800 text-[18px] font-bold min-h-[48px] px-4 rounded-xl transition-colors focus:outline-none focus:ring-4 focus:ring-slate-400"
                >
                  {copied ? <CheckCircle size={20} className="text-emerald-600" /> : <Share2 size={20} className="text-slate-500" />} 
                  {copied ? 'Link Copied!' : 'Share with family'}
                </button>
                
                <a 
                  href={`mailto:?subject=${encodeURIComponent(articleData.title)}&body=I thought you might find this article useful: ${window.location.href}`}
                  className="flex items-center gap-3 bg-white border border-slate-300 hover:bg-slate-50 text-slate-800 text-[18px] font-bold min-h-[48px] px-4 rounded-xl transition-colors focus:outline-none focus:ring-4 focus:ring-slate-400"
                >
                  <Mail size={20} className="text-slate-500" /> Email to a friend
                </a>
              </div>
            </div>
            
          </aside>

          {/* ГЛАВНЫЙ КОНТЕНТ СТАТЬИ (Portable Text Render Area) */}
          <article className="lg:col-span-8 bg-white p-8 md:p-12 rounded-[2rem] shadow-sm border border-slate-200">
            
            {/* Классы prose адаптированы для 60+: 
              Шрифт 20px, цвет slate-800 (AAA контраст), большие интервалы
            */}
            <div className="prose prose-slate max-w-none prose-p:text-[20px] prose-p:leading-relaxed prose-p:text-slate-800 prose-headings:font-serif prose-headings:text-slate-900 prose-h2:text-3xl prose-h2:mt-12 prose-h2:mb-6 prose-li:text-[20px] prose-li:text-slate-800">
              
              <h2 id="what-is-vat-relief">What is VAT Relief?</h2>
              <p>
                VAT relief is a government scheme designed to reduce the financial burden on individuals who require specialized equipment due to a disability or a chronic medical condition. In the context of mobility bathing, this means you may not have to pay the standard 20% VAT on your new walk-in bath or its installation.
              </p>
              <p>
                This isn't a complex rebate system where you claim money back later. If you qualify, the VAT is simply removed from your total bill upfront. We handle the paperwork, making the process completely hassle-free for you.
              </p>

              <h2 id="who-qualifies">Who qualifies for 0% VAT?</h2>
              <p>
                According to HM Revenue & Customs (HMRC), to qualify for zero-rated VAT on adapted products, you must meet two main criteria:
              </p>
              <ul>
                <li>You must have a physical or mental impairment which has a long-term and substantial adverse effect upon your ability to carry out everyday activities.</li>
                <li>Or, you have a condition that the medical profession treats as a chronic sickness (e.g., Diabetes, Arthritis).</li>
                <li>The product being purchased must be specifically designed or adapted to assist with that disability (all our walk-in baths qualify).</li>
              </ul>

              {/* Мягкий инлайн-блок CTA внутри статьи */}
              <div className="bg-[#FAFAF9] border-l-4 border-teal-700 p-6 md:p-8 rounded-r-2xl my-10 not-prose print:border-none print:bg-white print:p-0">
                <h4 className="text-[22px] font-bold text-slate-900 mb-2">Unsure if you qualify?</h4>
                <p className="text-[18px] text-slate-700 mb-4">
                  Our team deals with VAT relief forms every day. Call us for a quick, confidential chat, and we'll tell you immediately if you are eligible to save 20%.
                </p>
                <a href="tel:08001234567" className="inline-flex items-center gap-2 bg-teal-700 hover:bg-teal-800 text-white font-bold text-[18px] px-6 py-3 min-h-[48px] rounded-lg transition-colors focus:outline-none focus:ring-4 focus:ring-teal-500/50">
                  <Phone size={20} /> Speak to an expert
                </a>
              </div>

              <h2 id="eligible-conditions">Examples of eligible conditions</h2>
              <p>
                Many people don't realize they qualify. Age alone does not qualify you for VAT relief, but many age-related conditions do. Common eligible conditions include:
              </p>
              <ul>
                <li>Arthritis (Osteoarthritis and Rheumatoid)</li>
                <li>Heart conditions and Angina</li>
                <li>Multiple Sclerosis (MS)</li>
                <li>Parkinson's Disease</li>
                <li>COPD and severe Asthma</li>
                <li>Anyone registered as terminally ill</li>
              </ul>

              <h2 id="how-to-claim">How to claim your exemption</h2>
              <p>
                We have made claiming VAT relief incredibly simple. You do not need to involve your doctor or send us medical records. 
              </p>
              <p>
                During your free home survey or over the phone, our representative will provide you with a simple "Eligibility Declaration" form. You simply sign this form stating your condition. We then deduct the 20% VAT from your final quote immediately. We keep the form on file for our records with HMRC.
              </p>

            </div>

            {/* Блок доверия в конце статьи */}
            <div className="mt-16 pt-8 border-t border-slate-200 print:hidden">
              <div className="flex flex-col sm:flex-row items-center gap-6 bg-slate-50 p-6 rounded-2xl border border-slate-100">
                <div className="w-16 h-16 bg-teal-100 rounded-full flex items-center justify-center flex-shrink-0">
                  <ShieldCheck size={32} className="text-teal-700" />
                </div>
                <div>
                  <h4 className="font-bold text-[20px] text-slate-900 mb-1">Written by Odyssey Experts</h4>
                  <p className="text-[16px] text-slate-600">
                    Our advice is based on years of experience helping UK families find safe bathing solutions. We ensure all our guides align with current UK regulations and industry best practices.
                  </p>
                </div>
              </div>
            </div>

          </article>

        </div>
      </section>

      {/* --- 3. RELATED GUIDES (Что читать дальше) --- */}
      <section className="py-16 bg-[#F1F1EF] border-t border-slate-200 print:hidden">
        <div className="max-w-7xl mx-auto px-6 md:px-8">
          <h2 className="font-serif text-3xl md:text-4xl font-extrabold text-slate-900 mb-10">
            Related Guides
          </h2>
          
          <div className="grid md:grid-cols-3 gap-8">
            {relatedArticles.map(post => (
              <article key={post.id} className="bg-white rounded-2xl shadow-sm border border-slate-200 flex flex-col overflow-hidden group focus-within:ring-4 focus-within:ring-teal-500/50">
                <div className="p-8 flex flex-col flex-grow">
                  <div className="flex items-center gap-3 text-slate-500 text-[14px] font-medium mb-4">
                    <span className="bg-slate-100 text-slate-700 px-2 py-1 rounded">{post.category}</span>
                    <span className="flex items-center gap-1"><Clock size={14} /> {post.readTime}</span>
                  </div>
                  <h3 className="font-serif text-[20px] font-bold text-slate-900 mb-3 leading-snug group-hover:text-teal-800 transition-colors">
                    <a href={`/guides/${post.id}`} className="focus:outline-none">
                      {post.title}
                    </a>
                  </h3>
                  <p className="text-[16px] text-slate-600 leading-relaxed mb-6 flex-grow">
                    {post.excerpt}
                  </p>
                  <a href={`/guides/${post.id}`} className="inline-flex items-center gap-2 text-teal-700 font-bold text-[18px] focus:outline-none rounded">
                    Read article <ChevronRight size={20} />
                  </a>
                </div>
              </article>
            ))}
          </div>
        </div>
      </section>

      {/* --- 4. FINAL CTA (Lead Gen) --- */}
      <section className="max-w-5xl mx-auto px-6 py-12 print:hidden">
        <div className="bg-slate-900 rounded-[2rem] p-10 md:p-16 text-center text-white shadow-xl relative overflow-hidden">
          <div className="relative z-10">
            <h2 className="font-serif text-3xl md:text-4xl lg:text-5xl font-extrabold mb-6 leading-tight">
              Ready to take the next step?
            </h2>
            <p className="text-[20px] text-slate-300 mb-10 max-w-2xl mx-auto leading-relaxed">
              If you found this guide helpful and want to discuss your specific needs, our team is here to help. No hard sell, just friendly advice.
            </p>
            
            <div className="flex flex-col sm:flex-row items-center justify-center gap-4">
              <a href="tel:08001234567" className="flex items-center justify-center gap-3 bg-white text-slate-900 text-[20px] font-extrabold min-h-[64px] px-8 rounded-xl hover:bg-slate-100 transition-colors w-full sm:w-auto focus:outline-none focus:ring-4 focus:ring-white/50">
                <Phone size={24} className="text-teal-700" />
                0800 123 4567
              </a>
              <a href="/contact" className="flex items-center justify-center bg-teal-700 hover:bg-teal-600 text-white text-[20px] font-bold min-h-[64px] px-8 rounded-xl transition-colors border border-teal-600 w-full sm:w-auto focus:outline-none focus:ring-4 focus:ring-teal-500/50">
                Request Free Brochure
              </a>
            </div>
            <p className="text-[16px] text-slate-400 mt-6 flex items-center justify-center gap-2 font-medium">
              <Info size={18} /> Call us Monday to Friday, 9am to 5pm
            </p>
          </div>
        </div>
      </section>

    </div>
  );
};

export default OdysseyArticle;